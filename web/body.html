<!DOCTYPE HTML>
<html lang=en>
  <head>
    <title>Cross Section DB</title>
  </head>

  <body>

    <form>
      Sample Regex: <input type="text" name="sample" value="<?php echo $sample?>">
      Energy: <input type="text" name="energy" value="<?php echo $energy?>">
      Check for historic info: <input type="checkbox" name="history"<?php if ($history) echo ' checked';?>>
      <input type="hidden" name="browse" value="true">
      <input type="submit">
    </form>

    <table border="1" cellpadding="5" align="center">
      <tr>
        <th>Sample</th>
        <th>Cross Section</th>
        <th>Last Updated</th>
        <th>Source</th>
        <th>Comments</th>
      </tr>
      <?php
      if ($result->num_rows > 0) {
        while($row = $result->fetch_assoc()) {

          $cross_sec_string = (string)$row['cross_section'];
          if (strpos($cross_sec_string, '.') !== false && strpos($cross_sec_string, 'e') === false)
            $cross_sec_string = rtrim($cross_sec_string, '0');

          $sample_str = $row['sample'];

          if (! $history)
             $sample_str = '<a href="?sample=' . $sample_str . '&energy=' . $energy . '&browse=true&history=on">' . $sample_str . '</a>';

          if ($sample === '' or preg_match('/' . $sample . '/', $row['sample']))
            printf('<tr><td>%s</td><td>%s</td><td>%s</td><td>%s</td><td>%s</td></tr>',
                   $sample_str, $cross_sec_string, $row['last_updated'],
                   $row['source'], $row['comments']);
        }
      }
      ?>        
    </table>

  </body>
</html>
